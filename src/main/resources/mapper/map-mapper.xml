<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.animal.mapper.MapMapper">

    <insert id="addWalk" parameterType="WalkAddReq" useGeneratedKeys="true" keyProperty="logId">
        insert into WALKINGLOGS
        (user_idx,
         walk_name,
         walk_date,
         start_time,
         end_time,
         distance,
         duration)
        VALUES (#{userIdx},#{walkName}, #{walkDate}, #{startTime}, #{endTime}, #{distance}, #{duration})
    </insert>

    <insert id="addPath" parameterType="PathAddReq">
        insert into WALKINGPATHS
        (
         log_id,
         sequence,
         latitude,
         longitude)
            VALUES(#{logId}, #{sequence}, #{latitude}, #{longitude})


    </insert>

    <select id="getWalks" parameterType="Long" resultType="WalkDTO">
        select log_id,
               walk_name,
               walk_date,
               start_time,
               end_time,
               distance,
               duration
        FROM walkinglogs
        WHERE user_idx = #{userIdx}
        ORDER BY walk_date DESC, start_time DESC
    </select>

    <select id="getPaths" parameterType="Long" resultType="PathDTO">
        select path_id,
               log_id,
               sequence,
               latitude,
               longitude
        FROM walkingpaths
        WHERE log_id IN (
        SELECT log_id
        FROM walkinglogs
        WHERE user_idx = #{userIdx})
        ORDER BY log_id, sequence;
    </select>
</mapper>